# 💳 Replicate 购买额度指南

## 🚀 快速购买步骤

### 步骤 1: 登录 Replicate 账户
访问: https://replicate.com/account/billing

### 步骤 2: 选择付款方式
Replicate 支持两种付费模式：

#### 模式 1: Pay-as-you-go (按需付费) ⭐ 推荐
- **无需预充值**
- **绑定信用卡后自动扣款**
- **按实际使用量计费**
- 适合大部分用户

#### 模式 2: Prepaid Credits (预付费充值)
- **提前购买额度**
- **用完后需要再次充值**
- 适合预算控制需求

---

## 💰 定价说明

### Illusion Diffusion HQ 模型定价
你当前使用的模型: `lucataco/illusion-diffusion-hq`

**计费标准:**
- 每次生成约 **$0.0055 - $0.008**
- 按推理步数和生成时间计费
- 平均每张图 **不到 1 美分**

**示例计算:**
- 生成 100 张图 ≈ $0.55 - $0.80
- 生成 1000 张图 ≈ $5.50 - $8.00

---

## 🛒 具体购买流程

### 方法 1: 设置自动付款 (推荐)

1. **访问账单页面**
   ```
   https://replicate.com/account/billing
   ```

2. **添加支付方式**
   - 点击 "Add payment method"
   - 输入信用卡信息 (支持 Visa, Mastercard, American Express)
   - 保存支付方式

3. **设置消费限额 (可选)**
   - 在 "Spending limit" 设置每月最高消费
   - 例如: $10/month, $50/month
   - 到达限额后自动停止调用

4. **完成设置**
   - 系统会在每月初自动结算上月费用
   - 无需手动充值

### 方法 2: 购买预付费额度

1. **访问账单页面**
   ```
   https://replicate.com/account/billing
   ```

2. **选择充值金额**
   - 最低充值: $5
   - 推荐充值: $10 - $50
   - 可自定义金额

3. **完成支付**
   - 输入信用卡信息
   - 确认充值金额
   - 点击 "Add credits"

4. **查看余额**
   - 在 Dashboard 查看剩余额度
   - 用完后需要再次充值

---

## 📊 费用预估

### 你的使用场景估算

假设每天生成 **10 张 Milady 特效图**:

| 使用量 | 每张成本 | 每日费用 | 每月费用 |
|--------|----------|----------|----------|
| 10 张/天 | $0.007 | $0.07 | ~$2.10 |
| 50 张/天 | $0.007 | $0.35 | ~$10.50 |
| 100 张/天 | $0.007 | $0.70 | ~$21.00 |

**结论**: 使用成本非常低，建议充值 $10-$20 可用很久

---

## 🎯 推荐配置

### 新手推荐 (低风险)
```
方式: 预付费充值
金额: $10
预计可用: 约 1400 张图
适合: 测试阶段
```

### 正式使用推荐
```
方式: 自动付款 + 消费限额
限额: $20/month
优点: 无需手动充值，自动结算
适合: 长期使用
```

### 高频使用推荐
```
方式: 自动付款 + 消费限额
限额: $50/month 或更高
优点: 不用担心余额不足
适合: 机器人服务、高频调用
```

---

## 🔍 查看使用情况

### 实时监控余额和使用量

1. **访问 Dashboard**
   ```
   https://replicate.com/account
   ```

2. **查看用量统计**
   - 本月已使用金额
   - 剩余额度 (预付费模式)
   - 每日/每周使用趋势

3. **查看详细账单**
   ```
   https://replicate.com/account/billing/invoices
   ```
   - 每次 API 调用的详细费用
   - 按模型分类的使用统计
   - 下载 CSV 导出

---

## 💡 省钱技巧

### 1. 降低推理步数
```python
# 在 replicate_config.py 修改
NUM_INFERENCE_STEPS = 30  # 从 40 降到 30，节省约 25% 费用
```

**影响**: 质量略降，速度更快，费用更低

### 2. 批量生成时使用缓存
- Replicate 会缓存相同参数的请求
- 相同的 prompt + 控制图会更便宜

### 3. 设置消费限额
```
在 Billing 页面设置月度限额
避免意外超支
```

---

## ⚠️ 注意事项

### 1. 支付方式限制
- **必须使用国际信用卡** (Visa, Mastercard, Amex)
- 不支持国内银联卡
- 不支持 PayPal (部分地区)

### 2. 地区限制
- 中国大陆用户可能需要科学上网访问
- 建议使用海外信用卡

### 3. 账单结算
- 自动付款: 每月 1 号结算上月费用
- 预付费: 实时扣款

### 4. 余额不足处理
- **自动付款模式**: 自动扣款，不会中断服务
- **预付费模式**: 余额不足时 API 调用失败
  - 错误信息: "Insufficient credits"
  - 需要手动充值

---

## 🆘 常见问题

### Q: 我没有国际信用卡怎么办？
A: 可以尝试:
1. 申请虚拟信用卡 (如 Wise, Revolut)
2. 使用朋友的信用卡代充
3. 寻找支持支付宝的代充服务 (不推荐，有风险)

### Q: 我的信用卡支付失败？
A: 检查:
1. 卡是否开通国际支付
2. 卡内余额是否足够
3. 银行是否拦截了交易 (联系银行解除)
4. 尝试更换其他信用卡

### Q: 如何取消自动付款？
A:
1. 访问 https://replicate.com/account/billing
2. 点击 "Remove payment method"
3. 确认取消

### Q: 预付费余额可以退款吗？
A: 不可以，Replicate 不支持余额退款

### Q: 如何查看每次 API 调用的费用？
A:
1. 访问 https://replicate.com/account/billing
2. 点击 "Usage" 标签
3. 查看详细的调用记录和费用

### Q: 费用为什么比预估的高？
A: 可能原因:
1. 推理步数设置过高 (`NUM_INFERENCE_STEPS`)
2. 同时生成多张图
3. 使用了更昂贵的模型
4. 生成失败后的重试也会计费

---

## 🔗 相关链接

- **Replicate 账单页面**: https://replicate.com/account/billing
- **定价说明**: https://replicate.com/pricing
- **使用统计**: https://replicate.com/account
- **模型详情**: https://replicate.com/lucataco/illusion-diffusion-hq

---

## 📝 快速操作清单

完成以下步骤即可开始使用:

- [ ] 访问 https://replicate.com/account/billing
- [ ] 添加支付方式 (信用卡)
- [ ] 选择付费模式:
  - [ ] 自动付款 + 设置月度限额 (推荐 $20)
  - [ ] 或充值预付费额度 (推荐 $10-$20)
- [ ] 测试生成一张图，确认扣费成功
- [ ] 定期查看用量统计

---

## 💬 需要帮助？

如果购买过程中遇到问题:
1. 查看 Replicate 官方文档: https://replicate.com/docs
2. 联系 Replicate 支持: support@replicate.com
3. 查看你的 webhook.log 了解 API 调用失败原因

---

**提示**: 建议先充值 $10 测试，确认服务正常后再决定是否使用自动付款模式。
